Z_s_new_2 <- t(c_2) %*% solve(C_2) %*% transect$Z.s
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10))
lines(s.new, Z_s_new_1, col = 2)
lines(s.new, Z_s_new_2, col = 3)
legend("topleft",legend = c("v = 1/2", "v = 5/4"), col = c(2,3), lwd = 1)
# d)
s.new <- seq(0, 10, 0.001)
dist_mat_new <- rdist(transect$s, s.new)
# calculate the cov matrix for v = 1/2
c_1 <- mat_1(dist_mat_new, 3,1)
# compute the cov matrix for v = 5/2
c_2 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2))
# e)
Z_s_new_1 <- t(c_1) %*% solve(C_1) %*% transect$Z.s
Z_s_new_2 <- t(c_2) %*% solve(C_2) %*% transect$Z.s
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10))
lines(s.new, Z_s_new_1, col = 2)
lines(s.new, Z_s_new_2, col = 3)
legend("topright",legend = c("v = 1/2", "v = 5/4"), col = c(2,3), lwd = 1)
# f)
# the the same for diffferent nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", nu, col = 2:5, lwd = 1)
# f)
# the the same for diffferent nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# f)
# the the same for diffferent nuggets
nu <- seq(0,0.9, length = 5)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:5){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:6, lwd = 1)
# f)
# the the same for v = 1/2 different nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 1/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/4 diffferent nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
?cov.mat
# f)
# the the same for v = 1/2 different nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 1/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/4 diffferent nuggets
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 1/2 different ranges
range <- seq(0.2, 5, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 1/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 1/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# f)
# the the same for v = 1/2 different nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/4 diffferent nuggets
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 1/2 different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 1/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 1/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# f)
# the the same for v = 1/2 for different nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/4 for diffferent nuggets
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 1/2 for different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 1/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 1/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/2 for different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 5/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 5/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# f)
# the the same for v = 1/2 for different nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/4 for diffferent nuggets
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 1/2 for different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 1/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 1/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/2 for different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 5/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 5/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# f)
# the the same for v = 1/2 for different nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/4 for diffferent nuggets
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 1/2 for different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 1/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 1/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = range, col = 2:5, lwd = 1)
# the the same for v = 5/2 for different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 5/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 5/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = range, col = 2:5, lwd = 1)
knitr::opts_chunk$set(echo = TRUE)
fram <- read.table("fram.txt", header = TRUE)
fram <- read.table("fram.txt", header = TRUE)
View(fram)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
# calculate w for exam 3
fram$w <- log((fram$sbp31+fram$sbp32)/2-50)
View(fram)
summary(fram)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
print(mse)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
print(mse)
# b)
model_1 <- glm(firstchdd~w+age+smoking,family = binomial(link = "logit"), data = sim2)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
print(mse)
# b)
model_1 <- glm(firstchdd~w+age+smoking,family = binomial(link = "logit"), data = fram)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
print(mse)
# b)
model_1 <- glm(firstchd~w+age+smoking,family = binomial(link = "logit"), data = fram)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
print(mse)
# b)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram)
summary(model_1)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
print(mse)
# b)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram)
summary(model_1)
exp(coef(model_1))
?simex
# c)
require(simex)
set.seed(123)
install.packages("simex")
# c)
require(simex)
set.seed(123)
?`simex-package`
?simex
# c)
require(simex)
set.seed(123)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram)
simex.model <- simex(model = model_1, SIMEXvariable = "w", measurement.error = sqrt(mse))
# c)
require(simex)
set.seed(123)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram)
simex.model <- simex(model = model_1, SIMEXvariable = "w", measurement.error = sqrt(mse), x = TRUE)
?glm
# c)
require(simex)
set.seed(123)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram, x = TRUE)
simex.model <- simex(model = model_1, SIMEXvariable = "w", measurement.error = sqrt(mse))
# c)
require(simex)
set.seed(123)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram, x = TRUE)
simex.model <- simex(model = model_1, SIMEXvariable = "w", measurement.error = sqrt(mse))
simex.model
plot(fram$firstchd, fram$age)
plot(fram$firstchd, fram$age)
plot(fram$age, fram$firstchd)
boxplot(fram$firstchd~fram$age)
boxplot(fram$firstchd~fram$age)
boxplot(fram$age~fram$firstchd)
boxplot(fram$smoke~fram$firstchd)
boxplot(fram$w~fram$firstchd)
# c)
require(simex)
set.seed(123)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram, x = TRUE)
simex.model <- simex(model = model_1, SIMEXvariable = "w", measurement.error = sqrt(mse))
simex.model
plot(simex.model, mfrow = c(2, 2))
plot(simex.model)
# c)
require(simex)
set.seed(123)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram, x = TRUE)
simex.model <- simex(model = model_1, SIMEXvariable = "w", measurement.error = sqrt(mse))
simex.model
par( mfrow = c(2, 2))
plot(simex.model)
exp(1.73)
# load the data
data_B_all <- read.csv('Data/dataframe_B_f_and_a.csv', header = TRUE)
data_B_all <- na.omit(data_B_all)
# load the data
data_B_all <- read.csv('Data/dataframe_B_f_and_a.csv', header = TRUE)
setwd("~/Documents/GitHub/Spotify")
# load the data
data_B_all <- read.csv('Data/dataframe_B_f_and_a.csv', header = TRUE)
data_B_all <- na.omit(data_B_all)
#remove not possible values
data_B_all <- data_B_all[data_B_all$rd_year>500,]
# Randomly shuffle the data
data_B_all <-data_B_all[sample(nrow(data_B_all)),-c(1,2,5,7,17,21,22,23)]
# Scale the timbres
data_B_all[,103:126] <- as.data.frame(scale(data_B_all[,103:126]))
# Create 10 equally size folds
folds <- cut(seq(1,nrow(data_B_all)),breaks=10,labels=FALSE)
# Perform 10 fold cross validation
err_lreg_mae <- err_lreg_mse <- numeric(10)
for(i in 1:10){
#Segement your data by fold using the which() function
testIndexes <- which(folds==i,arr.ind=TRUE)
testData <- data_B_all[testIndexes, ]
trainData <- data_B_all[-testIndexes, ]
# Lin reg
l_reg <- lm(popularity~., data= trainData)
pred_ch_r <- predict(l_reg, testData[,-14])
err_lreg_mae[i] <- sum(abs(pred_ch_r-testData$popularity))/length(pred_ch_r)
err_lreg_mse[i] <- sum((pred_ch_r-testData$popularity)^2)/length(pred_ch_r)
}
# ma error of the mean
sum(err_lreg_mae)/10
# ms error of the mean
sum(err_lreg_mse)/10
library(glmnet)
#Perform 10 fold cross validation
err_mae <- err_mse <- zeros <-  numeric(10)
for(i in 1:10){
# Segement your data by fold using the which() function
testIndexes <- which(folds==i,arr.ind=TRUE)
testData <- data_B_all[testIndexes, ]
trainData <- data_B_all[-testIndexes, ]
# Lasso
fit <- cv.glmnet(as.matrix(trainData[,-14]), as.matrix(trainData[ , 14]), alpha = 1)
pred_ch_r <- predict(fit, as.matrix(testData[,-14]))
err_mae[i] <- sum(abs(pred_ch_r-testData$popularity))/length(pred_ch_r)
err_mse[i] <- sum((pred_ch_r-testData$popularity)^2)/length(pred_ch_r)
zeros[i] <- sum(coefficients(fit)==0)/length(coefficients(fit))
}
# ma error of the mean
sum(err_mae)/10
# ms error of the mean
sum(err_mse)/10
# fraction of coeff == 0 mean
sum(zeros)/10
library(randomForest)
#Perform 10 fold cross validation
err_mae <- err_mse <- numeric(10)
for(i in 1:10){
#Segement your data by fold using the which() function
testIndexes <- which(folds==i,arr.ind=TRUE)
testData <- data_B_all[testIndexes, ]
trainData <- data_B_all[-testIndexes, ]
#random forest
fit <- randomForest(as.matrix(trainData[,-14]), as.matrix(trainData[ , 14]), ntree = 100)
pred_ch_r <- predict(fit, as.matrix(testData[,-14]))
err_mae[i] <- sum(abs(pred_ch_r-testData$popularity))/length(pred_ch_r)
err_mse[i] <- sum((pred_ch_r-testData$popularity)^2)/length(pred_ch_r)
}
# ma error of the mean
sum(err_mae)/10
# ms error of the mean
sum(err_mse)/10
#random forest
data_B.rf <- randomForest(as.matrix(data_B_all[,-14]), as.matrix(data_B_all[ , 14]), importance = TRUE)
tiff('Plots/B_dependance_rf.tiff', width = 8, height = 6, units = 'in', res = 200)
varImpPlot(data_B.rf)
dev.off()
tiff('Plots/B_parital_rf_year.tiff', width = 8, height = 6, units = 'in', res = 200)
partialPlot(data_B.rf, data_B_all, x.var = rd_year)
dev.off()
tiff('Plots/B_parital_rf_inst.tiff', width = 8, height = 6, units = 'in', res = 200)
partialPlot(data_B.rf, data_B_all, x.var = instrumentalness)
dev.off()
library(rpart)
library(partykit)
reg.tree = rpart(popularity ~ rd_year+instrumentalness+timbre_mean_6 + duration, data=data_B_all)
tiff('Plots/B_reg_tree.tiff', width = 8, height = 6, units = 'in', res = 200)
plot(as.party(reg.tree))
dev.off()
