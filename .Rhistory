c_3 <- cov.mat(dist_mat_new, c(1,1,smoothness = 1, 0.3))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10))
lines(s.new, Z_s_new_3, col = 2)
# d)
# compute the cov matrix for v = 5/2
C_3 <- cov.mat(dist_mat, c(1,1,smoothness = 1,0.1))
# compute the cov matrix for v = 5/2
c_3 <- cov.mat(dist_mat_new, c(1,1,smoothness = 1, 0.1))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10))
lines(s.new, Z_s_new_3, col = 2)
# d)
# compute the cov matrix for v = 5/2
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5))
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1,0.1))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1, 0.1))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = 2)
# d)
s.new <- seq(0, 10, 0.001)
dist_mat_new <- rdist(transect$s, s.new)
# calculate the cov matrix for v = 1/2
c_1 <- mat_1(dist_mat_new, 3,1)
# compute the cov matrix for v = 5/2
c_2 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2))
# e)
Z_s_new_1 <- t(c_1) %*% solve(C_1) %*% transect$Z.s
Z_s_new_2 <- t(c_2) %*% solve(C_2) %*% transect$Z.s
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10))
lines(s.new, Z_s_new_1, col = 2)
lines(s.new, Z_s_new_2, col = 3)
legend(c("v = 1/2", "v = 5/4"), col = c(2,3), lwd = 1)
# d)
s.new <- seq(0, 10, 0.001)
dist_mat_new <- rdist(transect$s, s.new)
# calculate the cov matrix for v = 1/2
c_1 <- mat_1(dist_mat_new, 3,1)
# compute the cov matrix for v = 5/2
c_2 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2))
# e)
Z_s_new_1 <- t(c_1) %*% solve(C_1) %*% transect$Z.s
Z_s_new_2 <- t(c_2) %*% solve(C_2) %*% transect$Z.s
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10))
lines(s.new, Z_s_new_1, col = 2)
lines(s.new, Z_s_new_2, col = 3)
legend(legend = c("v = 1/2", "v = 5/4"), col = c(2,3), lwd = 1)
# d)
s.new <- seq(0, 10, 0.001)
dist_mat_new <- rdist(transect$s, s.new)
# calculate the cov matrix for v = 1/2
c_1 <- mat_1(dist_mat_new, 3,1)
# compute the cov matrix for v = 5/2
c_2 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2))
# e)
Z_s_new_1 <- t(c_1) %*% solve(C_1) %*% transect$Z.s
Z_s_new_2 <- t(c_2) %*% solve(C_2) %*% transect$Z.s
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10))
lines(s.new, Z_s_new_1, col = 2)
lines(s.new, Z_s_new_2, col = 3)
legend("topleft",legend = c("v = 1/2", "v = 5/4"), col = c(2,3), lwd = 1)
# d)
s.new <- seq(0, 10, 0.001)
dist_mat_new <- rdist(transect$s, s.new)
# calculate the cov matrix for v = 1/2
c_1 <- mat_1(dist_mat_new, 3,1)
# compute the cov matrix for v = 5/2
c_2 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2))
# e)
Z_s_new_1 <- t(c_1) %*% solve(C_1) %*% transect$Z.s
Z_s_new_2 <- t(c_2) %*% solve(C_2) %*% transect$Z.s
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10))
lines(s.new, Z_s_new_1, col = 2)
lines(s.new, Z_s_new_2, col = 3)
legend("topright",legend = c("v = 1/2", "v = 5/4"), col = c(2,3), lwd = 1)
# f)
# the the same for diffferent nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", nu, col = 2:5, lwd = 1)
# f)
# the the same for diffferent nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# f)
# the the same for diffferent nuggets
nu <- seq(0,0.9, length = 5)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:5){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:6, lwd = 1)
# f)
# the the same for v = 1/2 different nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 1/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/4 diffferent nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
?cov.mat
# f)
# the the same for v = 1/2 different nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 1/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/4 diffferent nuggets
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 1/2 different ranges
range <- seq(0.2, 5, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 1/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 1/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# f)
# the the same for v = 1/2 different nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/4 diffferent nuggets
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 1/2 different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 1/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 1/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# f)
# the the same for v = 1/2 for different nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/4 for diffferent nuggets
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 1/2 for different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 1/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 1/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/2 for different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 5/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 5/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# f)
# the the same for v = 1/2 for different nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/4 for diffferent nuggets
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 1/2 for different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 1/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 1/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/2 for different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 5/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 5/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# f)
# the the same for v = 1/2 for different nuggets
nu <- seq(0,0.9, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 1/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 1/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 5/4 for diffferent nuggets
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 5/2, different nuggets")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(1,3,smoothness = 5/2,nu[i]))
c_3 <- cov.mat(dist_mat_new, c(1,3,smoothness = 5/2, nu[i]))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = nu, col = 2:5, lwd = 1)
# the the same for v = 1/2 for different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-5,5), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 1/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 1/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = range, col = 2:5, lwd = 1)
# the the same for v = 5/2 for different ranges
range <- seq(0.2, 3, length = 4)
plot(transect$s,transect$Z.s, xlim = c(0,10), ylim = c(-10,10), main = "v = 1/2, different ranges")
for (i in 1:4){
C_3 <- cov.mat(dist_mat, c(range[i],3,smoothness = 5/2))
c_3 <- cov.mat(dist_mat_new, c(range[i],3,smoothness = 5/2))
Z_s_new_3 <- t(c_3) %*% solve(C_3) %*% transect$Z.s
lines(s.new, Z_s_new_3, col = i+1)
}
legend("topright", legend = range, col = 2:5, lwd = 1)
knitr::opts_chunk$set(echo = TRUE)
fram <- read.table("fram.txt", header = TRUE)
fram <- read.table("fram.txt", header = TRUE)
View(fram)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
# calculate w for exam 3
fram$w <- log((fram$sbp31+fram$sbp32)/2-50)
View(fram)
summary(fram)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
print(mse)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
print(mse)
# b)
model_1 <- glm(firstchdd~w+age+smoking,family = binomial(link = "logit"), data = sim2)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
print(mse)
# b)
model_1 <- glm(firstchdd~w+age+smoking,family = binomial(link = "logit"), data = fram)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
print(mse)
# b)
model_1 <- glm(firstchd~w+age+smoking,family = binomial(link = "logit"), data = fram)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
print(mse)
# b)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram)
summary(model_1)
fram <- read.table("fram.txt")
names(fram) <- c("obs","age","sbp21","sbp22", "sbp31", "sbp32", "smoke", "cholest2", "cholest3", "firstchd")
w <- function(x){log(x-50)}
fram$w31 <- w(fram$sbp31)
fram$w32 <- w(fram$sbp32)
# a)
# calculate w for exam 3
fram$w <- (fram$w31+fram$w32)/2
error <- fram$w-fram$w31
mse <- mean(error^2)
print(mse)
# b)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram)
summary(model_1)
exp(coef(model_1))
?simex
# c)
require(simex)
set.seed(123)
install.packages("simex")
# c)
require(simex)
set.seed(123)
?`simex-package`
?simex
# c)
require(simex)
set.seed(123)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram)
simex.model <- simex(model = model_1, SIMEXvariable = "w", measurement.error = sqrt(mse))
# c)
require(simex)
set.seed(123)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram)
simex.model <- simex(model = model_1, SIMEXvariable = "w", measurement.error = sqrt(mse), x = TRUE)
?glm
# c)
require(simex)
set.seed(123)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram, x = TRUE)
simex.model <- simex(model = model_1, SIMEXvariable = "w", measurement.error = sqrt(mse))
# c)
require(simex)
set.seed(123)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram, x = TRUE)
simex.model <- simex(model = model_1, SIMEXvariable = "w", measurement.error = sqrt(mse))
simex.model
plot(fram$firstchd, fram$age)
plot(fram$firstchd, fram$age)
plot(fram$age, fram$firstchd)
boxplot(fram$firstchd~fram$age)
boxplot(fram$firstchd~fram$age)
boxplot(fram$age~fram$firstchd)
boxplot(fram$smoke~fram$firstchd)
boxplot(fram$w~fram$firstchd)
# c)
require(simex)
set.seed(123)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram, x = TRUE)
simex.model <- simex(model = model_1, SIMEXvariable = "w", measurement.error = sqrt(mse))
simex.model
plot(simex.model, mfrow = c(2, 2))
plot(simex.model)
# c)
require(simex)
set.seed(123)
model_1 <- glm(firstchd~w+age+smoke,family = binomial(link = "logit"), data = fram, x = TRUE)
simex.model <- simex(model = model_1, SIMEXvariable = "w", measurement.error = sqrt(mse))
simex.model
par( mfrow = c(2, 2))
plot(simex.model)
exp(1.73)
# read data
data_B <- read.csv('Data/dataframe_B_features.csv', header = TRUE)
setwd("~/Documents/GitHub/Spotify")
# read data
data_B <- read.csv('Data/dataframe_B_features.csv', header = TRUE)
data_B <- data_B[,-2]
# linear regression on recommended songs
l_reg <- lm(popularity~valence+loudness+acousticness+instrumentalness+speechiness+
liveness+mode+tempo+duration+key, data = data_B)
summary(l_reg)
# create the diagnostic plots for the linear regression
tiff('Plots/B_l_reg.tiff', width = 8, height = 6, units = 'in', res = 200)
par(mfrow = c(2,2))
plot(l_reg)
dev.off()
format(coef(l_reg), scientific=FALSE)
### logistic regression ###
log_reg <- glm(chart_random~acousticness + instrumentalness + loudness
+speechiness + valence, family = binomial(link = "logit"), data_A)
summary(log_reg)
#### load Data ####
dataA <- read.csv('Data/dataframe_A.csv', header = TRUE)
dataA <- dataA[,-4]
dataA$chart_random_f[dataA$chart_random==0] <- "random"
dataA$chart_random_f[dataA$chart_random==1] <- "chart"
dataA$chart_random_f <- as.factor(dataA$chart_random_f)
### logistic regression ###
log_reg <- glm(chart_random~acousticness + instrumentalness + loudness
+speechiness + valence, family = binomial(link = "logit"), data_A)
### logistic regression ###
log_reg <- glm(chart_random~acousticness + instrumentalness + loudness
+speechiness + valence, family = binomial(link = "logit"), dataA)
summary(log_reg)
exp(log_reg$coefficients[c(6,4,2,3,5)])
